<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Accounts and Balances BC | Mojaloop Reference Architecture Docs 1.0</title>
    <meta name="description" content="">
    
    <meta name="description" content="Mojaloop Reference Architecture 1.0">
    <meta name="theme-color" content="#00a3ff">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="preload" href="/reference-architecture-doc/assets/css/0.styles.a9215771.css" as="style"><link rel="preload" href="/reference-architecture-doc/assets/js/app.47e5814f.js" as="script"><link rel="preload" href="/reference-architecture-doc/assets/js/2.3ac1e7fc.js" as="script"><link rel="preload" href="/reference-architecture-doc/assets/js/7.518ab3a0.js" as="script"><link rel="prefetch" href="/reference-architecture-doc/assets/js/10.77d1b646.js"><link rel="prefetch" href="/reference-architecture-doc/assets/js/11.f017ab1c.js"><link rel="prefetch" href="/reference-architecture-doc/assets/js/12.c7026b16.js"><link rel="prefetch" href="/reference-architecture-doc/assets/js/13.4febd9c0.js"><link rel="prefetch" href="/reference-architecture-doc/assets/js/14.57caae8c.js"><link rel="prefetch" href="/reference-architecture-doc/assets/js/15.b07c017b.js"><link rel="prefetch" href="/reference-architecture-doc/assets/js/16.3ac154af.js"><link rel="prefetch" href="/reference-architecture-doc/assets/js/17.8243e98d.js"><link rel="prefetch" href="/reference-architecture-doc/assets/js/18.3a69e714.js"><link rel="prefetch" href="/reference-architecture-doc/assets/js/19.0b7c03b1.js"><link rel="prefetch" href="/reference-architecture-doc/assets/js/20.61b63a5d.js"><link rel="prefetch" href="/reference-architecture-doc/assets/js/21.666f1c41.js"><link rel="prefetch" href="/reference-architecture-doc/assets/js/22.be4b8586.js"><link rel="prefetch" href="/reference-architecture-doc/assets/js/23.d7daab1f.js"><link rel="prefetch" href="/reference-architecture-doc/assets/js/24.e0a18238.js"><link rel="prefetch" href="/reference-architecture-doc/assets/js/25.a07d8052.js"><link rel="prefetch" href="/reference-architecture-doc/assets/js/26.787f61cf.js"><link rel="prefetch" href="/reference-architecture-doc/assets/js/27.73a40601.js"><link rel="prefetch" href="/reference-architecture-doc/assets/js/28.55a9778f.js"><link rel="prefetch" href="/reference-architecture-doc/assets/js/29.37a5f920.js"><link rel="prefetch" href="/reference-architecture-doc/assets/js/3.e8dadafc.js"><link rel="prefetch" href="/reference-architecture-doc/assets/js/30.21d27da2.js"><link rel="prefetch" href="/reference-architecture-doc/assets/js/31.b7f305ac.js"><link rel="prefetch" href="/reference-architecture-doc/assets/js/32.3f3135ee.js"><link rel="prefetch" href="/reference-architecture-doc/assets/js/33.75f280dd.js"><link rel="prefetch" href="/reference-architecture-doc/assets/js/34.e91333d3.js"><link rel="prefetch" href="/reference-architecture-doc/assets/js/35.a858bbcb.js"><link rel="prefetch" href="/reference-architecture-doc/assets/js/4.d9c80617.js"><link rel="prefetch" href="/reference-architecture-doc/assets/js/5.e4e4f7f9.js"><link rel="prefetch" href="/reference-architecture-doc/assets/js/6.125a8a02.js"><link rel="prefetch" href="/reference-architecture-doc/assets/js/8.bdea22b7.js"><link rel="prefetch" href="/reference-architecture-doc/assets/js/9.fb12be10.js">
    <link rel="stylesheet" href="/reference-architecture-doc/assets/css/0.styles.a9215771.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="main-docs-wrapper"><div class="main-content-wrapper"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/reference-architecture-doc/" class="home-link router-link-active"><img src="/reference-architecture-doc/mojaloop_logo_med.png" alt="Mojaloop Reference Architecture Docs 1.0" class="logo"> <span class="site-name can-hide">Mojaloop Reference Architecture Docs 1.0</span></a> <!----> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/reference-architecture-doc/introduction/" class="nav-link">
  Introduction
  <!----></a></div><div class="nav-item"><a href="https://mojaloop.io/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Mojaloop
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div> <!----></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/reference-architecture-doc/introduction/" class="nav-link">
  Introduction
  <!----></a></div><div class="nav-item"><a href="https://mojaloop.io/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Mojaloop
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/reference-architecture-doc/introduction/" class="sidebar-link">Introduction</a></li><li><a href="/reference-architecture-doc/refarch/" class="sidebar-link">Reference Architecture Overview</a></li><li><section class="sidebar-group collapsable depth-0"><a href="/reference-architecture-doc/boundedContexts/" class="sidebar-heading clickable router-link-active open active"><span>Bounded Contexts</span> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 49.484 28.284" class="sidebar-arrow down"><g transform="translate(-229 -126.358)"><rect fill="currentColor" width="35" height="5" rx="2" transform="translate(229 151.107) rotate(-45)"></rect> <rect fill="currentColor" width="35" height="5" rx="2" transform="translate(274.949 154.642) rotate(-135)"></rect></g></svg></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/reference-architecture-doc/boundedContexts/commonTermsConventions/" class="sidebar-link">Common Terms &amp; Conventions</a></li><li><a href="/reference-architecture-doc/boundedContexts/accountLookupAndDiscovery/" class="sidebar-link">Account Lookup &amp; Discovery</a></li><li><a href="/reference-architecture-doc/boundedContexts/accountsAndBalances/" aria-current="page" class="active sidebar-link">Accounts &amp; Balances</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/reference-architecture-doc/boundedContexts/accountsAndBalances/#terms" class="active sidebar-link">Terms</a></li><li class="sidebar-sub-header"><a href="/reference-architecture-doc/boundedContexts/accountsAndBalances/#functional-overview-accounts-and-balances" class="sidebar-link">Functional Overview - Accounts and Balances</a></li><li class="sidebar-sub-header"><a href="/reference-architecture-doc/boundedContexts/accountsAndBalances/#use-cases" class="sidebar-link">Use Cases</a></li><li class="sidebar-sub-header"><a href="/reference-architecture-doc/boundedContexts/accountsAndBalances/#canonical-model" class="sidebar-link">Canonical Model</a></li></ul></li><li><a href="/reference-architecture-doc/boundedContexts/quotingAgreement/" class="sidebar-link">Quoting/Agreements</a></li><li><a href="/reference-architecture-doc/boundedContexts/auditing/" class="sidebar-link">Auditing</a></li><li><a href="/reference-architecture-doc/boundedContexts/fspInteropApi/" class="sidebar-link">FSP Interop API</a></li><li><a href="/reference-architecture-doc/boundedContexts/logging/" class="sidebar-link">Logging</a></li><li><a href="/reference-architecture-doc/boundedContexts/notificationsAndAlerts/" class="sidebar-link">Notifications And Alerts</a></li><li><a href="/reference-architecture-doc/boundedContexts/participantLifecycleManagement/" class="sidebar-link">Participant Lifecycle Management</a></li><li><a href="/reference-architecture-doc/boundedContexts/reporting/" class="sidebar-link">Reporting</a></li><li><a href="/reference-architecture-doc/boundedContexts/scheduling/" class="sidebar-link">Scheduling</a></li><li><a href="/reference-architecture-doc/boundedContexts/security/" class="sidebar-link">Security</a></li><li><a href="/reference-architecture-doc/boundedContexts/settlements/" class="sidebar-link">Settlements</a></li><li><a href="/reference-architecture-doc/boundedContexts/thirdPartyApi/" class="sidebar-link">Third Party API</a></li><li><a href="/reference-architecture-doc/boundedContexts/transfers/" class="sidebar-link">Transfers</a></li></ul></section></li><li><a href="/reference-architecture-doc/boundedContexts/commonInterfaces/" class="sidebar-link">Common Interface List</a></li><li><a href="/reference-architecture-doc/howToImplement/" class="sidebar-link">How to Implement</a></li><li><a href="/reference-architecture-doc/glossary/" class="sidebar-link">Glossary</a></li><li><a href="/reference-architecture-doc/furtherReading/" class="sidebar-link">Further Reading</a></li></ul> </aside> <main class="page"> <div class="content content__default"><h1 id="accounts-and-balances-bc"><a href="#accounts-and-balances-bc" class="header-anchor">#</a> Accounts and Balances BC</h1> <p>The Accounts and Balances BC acts as the “central ledger” for the system. It interacts primarily with the Settlements BC, Participants Lifecycle BC and Transfers BCs, and is a directed sub-system, which means that it is a dependency of the BCs that use it as a “financial system of record” for the financial accounting.</p> <p><strong>Note:</strong></p> <p>The Accounts and Balances BC contains a limited amount of logic to ensure that <strong>(a)</strong> the correct relationships are created and maintained between entities when an external BC creates, updates, queries or closes accounts and <strong>(b)</strong> the correct account limits are enforced (i.e. set and not exceeded) when an external BC attempts to create journal entries and <strong>(c)</strong> avoids duplicate ledger entries by using <em>Universal Unique Identifiers (UUID)</em> for unique journal entry identifiers.</p> <h2 id="terms"><a href="#terms" class="header-anchor">#</a> Terms</h2> <p>Terms with specific and commonly accepted meaning within the Bounded Context in which they are used.</p> <table><thead><tr><th>Term</th> <th>Description</th></tr></thead> <tbody><tr><td><strong>Account</strong></td> <td>Refers to a General Ledger account, a record in an accounting system that records the debit or credit entries that represent a financial transaction.</td></tr> <tr><td><strong>Journal Entry</strong></td> <td>Credit/Debit financial records against Account.</td></tr> <tr><td><strong>Balance</strong></td> <td>The amount available in an account, when the debits and credits have been factored in.</td></tr></tbody></table> <h2 id="functional-overview-accounts-and-balances"><a href="#functional-overview-accounts-and-balances" class="header-anchor">#</a> Functional Overview - Accounts and Balances</h2> <p><img src="/reference-architecture-doc/assets/img/ML2RA_A&amp;B-bcAccBal-FunctionalOverview_Mar22-c.c90bc76e.png" alt="Functional Overview - Accounts and Balances"></p> <blockquote><p>BC Functional Diagram: Accounts &amp; Balances Overview</p></blockquote> <h2 id="use-cases"><a href="#use-cases" class="header-anchor">#</a> Use Cases</h2> <h3 id="create-account"><a href="#create-account" class="header-anchor">#</a> Create Account</h3> <h4 id="description"><a href="#description" class="header-anchor">#</a> Description</h4> <p>The workflow provided by this UC enables the Switch to create new participant/transfer/settlement accounts in the System Ledger.  (Participant Account creation occurs from both the Participant Lifecycle Management and the Settlement BCs.  Examples of both have been provided in the Flow Diagrams below).</p> <p>Further, the workflow provides for specification of credit/debit Journal Entry limits, and to ensure that the Account is unique in the System Ledger.</p> <h4 id="flow-diagram"><a href="#flow-diagram" class="header-anchor">#</a> Flow Diagram</h4> <p>Account creation from <a href="/reference-architecture-doc/boundedContexts/participantLifecycleManagement/">Participant Lifecycle Management BC</a></p> <p><img src="/reference-architecture-doc/assets/img/ML2RA_PLM-ucAddParticipantAccountInit_Apr22-a_P1-1429.c89a7715.png" alt="Use Case - PLCM BC"><br> <img src="/reference-architecture-doc/assets/img/ML2RA_PLM-ucAddParticipantAccountAppro_Apr22-a_P2-1429.e6e11626.png" alt="Use Case - Add Participant Account - Approval (P2)"></p> <blockquote><p>UC Workflow Diagram: Add Participant Accounts</p></blockquote> <p>Account creation from <a href="/reference-architecture-doc/boundedContexts/settlements/">Settlements BC</a></p> <p><img src="/reference-architecture-doc/assets/img/ML2RA_SET-ucBootStrapSettleModViaConfig_Mar22-b.3431ae1c.png" alt="Use Case - Settlements BC"></p> <blockquote><p>UC Workflow Diagram: Bootstrap (Startup) Settlement Model via Configuration</p></blockquote> <h3 id="close-account"><a href="#close-account" class="header-anchor">#</a> Close Account</h3> <h4 id="description-2"><a href="#description-2" class="header-anchor">#</a> Description</h4> <p>Close a participant account in the System Ledger and prevent new journal entries from impacting it. <br>(Still to be determined: Drain collateral CR balances to another account automatically?)</p> <h3 id="query-account"><a href="#query-account" class="header-anchor">#</a> Query Account</h3> <h4 id="description-3"><a href="#description-3" class="header-anchor">#</a> Description</h4> <p>Query the status and balance for participant account.</p> <h4 id="flow-diagram-2"><a href="#flow-diagram-2" class="header-anchor">#</a> Flow Diagram</h4> <p>Query liquidity CR/DR limits from <a href="/reference-architecture-doc/boundedContexts/participantLifecycleManagement/">Participant Lifecycle Management BC</a></p> <p><img src="/reference-architecture-doc/assets/img/ML2RA_PLM-ucLiquidityCoverQuery_Apr22-a_1429.8f207c44.png" alt="Use Case - PLCM BC"></p> <blockquote><p>UC Workflow Diagram: Liquidity Cover Queries</p></blockquote> <h3 id="query-journal-entries"><a href="#query-journal-entries" class="header-anchor">#</a> Query Journal Entries</h3> <h4 id="description-4"><a href="#description-4" class="header-anchor">#</a> Description</h4> <p>Query Journal debit/credit Entries for an Account.</p> <h3 id="insert-journal-entry"><a href="#insert-journal-entry" class="header-anchor">#</a> Insert Journal Entry</h3> <h4 id="description-5"><a href="#description-5" class="header-anchor">#</a> Description</h4> <p>Insert a participant journal entry into the System Ledger specifying the debit and credit accounts (There are three ways through which participant journal entries can be made.  See the Flow Diagrams below for a description of each.)<br>
Respond with the updated account balance.</p> <h4 id="flow-diagram-3"><a href="#flow-diagram-3" class="header-anchor">#</a> Flow Diagram</h4> <p>Journal Entry insertion from <a href="/reference-architecture-doc/boundedContexts/transfers/">Transfers BC</a></p> <p><img src="/reference-architecture-doc/assets/img/ML2RA_Trf_ucPerformTrfUniMode_Mar22a.db35b3f1.png" alt="Use Case - Transfers BC"></p> <blockquote><p>UC Workflow Diagram: Perform Transfer (Universal Mode)</p></blockquote> <p>Journal Entry insertion from <a href="/reference-architecture-doc/boundedContexts/settlements/">Settlements BC</a> using <code>Deferred Net Settlement</code> (DNS) model</p> <p><img src="/reference-architecture-doc/assets/img/ML2RA_SET-ucDeferNetSettle_Mar22-a-P1-2.16964b5e.png" alt="Use Case - Settlements BC"></p> <blockquote><p>UC Workflow Diagram: Deferred Net Settlement - 19/10/2021</p></blockquote> <p>Journal Entry insertion from <a href="/reference-architecture-doc/boundedContexts/settlements/">Settlements BC</a> using <code>Immediate Gross Settlement</code> (IGS) model</p> <p><img src="/reference-architecture-doc/assets/img/ML2RA_SET-ucInstantGrossSettle_Mar22-a.62776c92.png" alt="Use Case - Settlements BC"></p> <blockquote><p>UC Workflow Diagram: Immediate Gross Settlement</p></blockquote> <h2 id="canonical-model"><a href="#canonical-model" class="header-anchor">#</a> Canonical Model</h2> <ul><li>Account
<ul><li>accountId</li> <li>ledgerAccountType</li> <li>ledgerAccountState</li> <li>debitLimit</li> <li>creditLimit</li> <li>debitBalance</li> <li>creditBalance</li></ul></li> <li>Journal Entry
<ul><li>journalEntryId</li> <li>debitAccountId</li> <li>creditAccountId</li> <li>journalEntryType</li> <li>transferAmount</li> <li>transferTimestamp</li></ul></li></ul></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">5/16/2022, 12:34:51 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/reference-architecture-doc/boundedContexts/accountLookupAndDiscovery/" class="prev">
        Account Lookup &amp; Discovery
      </a></span> <span class="next"><a href="/reference-architecture-doc/boundedContexts/quotingAgreement/">
        Quoting/Agreements
      </a>
      →
    </span></p></div> </main> <!----></div></div> <!----></div><div class="global-ui"><!----></div></div>
    
    <script src="/reference-architecture-doc/assets/js/app.47e5814f.js" defer></script><script src="/reference-architecture-doc/assets/js/2.3ac1e7fc.js" defer></script><script src="/reference-architecture-doc/assets/js/7.518ab3a0.js" defer></script>
  </body>
</html>
