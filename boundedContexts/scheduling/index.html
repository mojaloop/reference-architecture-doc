<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Scheduling BC | Mojaloop Reference Architecture Docs 1.0</title>
    <meta name="description" content="">
    
    <meta name="description" content="Mojaloop Reference Architecture 1.0">
    <meta name="theme-color" content="#00a3ff">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="preload" href="/reference-architecture-doc/assets/css/0.styles.a9215771.css" as="style"><link rel="preload" href="/reference-architecture-doc/assets/js/app.47e5814f.js" as="script"><link rel="preload" href="/reference-architecture-doc/assets/js/2.3ac1e7fc.js" as="script"><link rel="preload" href="/reference-architecture-doc/assets/js/16.3ac154af.js" as="script"><link rel="prefetch" href="/reference-architecture-doc/assets/js/10.77d1b646.js"><link rel="prefetch" href="/reference-architecture-doc/assets/js/11.f017ab1c.js"><link rel="prefetch" href="/reference-architecture-doc/assets/js/12.c7026b16.js"><link rel="prefetch" href="/reference-architecture-doc/assets/js/13.4febd9c0.js"><link rel="prefetch" href="/reference-architecture-doc/assets/js/14.57caae8c.js"><link rel="prefetch" href="/reference-architecture-doc/assets/js/15.b07c017b.js"><link rel="prefetch" href="/reference-architecture-doc/assets/js/17.8243e98d.js"><link rel="prefetch" href="/reference-architecture-doc/assets/js/18.3a69e714.js"><link rel="prefetch" href="/reference-architecture-doc/assets/js/19.0b7c03b1.js"><link rel="prefetch" href="/reference-architecture-doc/assets/js/20.61b63a5d.js"><link rel="prefetch" href="/reference-architecture-doc/assets/js/21.666f1c41.js"><link rel="prefetch" href="/reference-architecture-doc/assets/js/22.be4b8586.js"><link rel="prefetch" href="/reference-architecture-doc/assets/js/23.d7daab1f.js"><link rel="prefetch" href="/reference-architecture-doc/assets/js/24.e0a18238.js"><link rel="prefetch" href="/reference-architecture-doc/assets/js/25.a07d8052.js"><link rel="prefetch" href="/reference-architecture-doc/assets/js/26.787f61cf.js"><link rel="prefetch" href="/reference-architecture-doc/assets/js/27.73a40601.js"><link rel="prefetch" href="/reference-architecture-doc/assets/js/28.55a9778f.js"><link rel="prefetch" href="/reference-architecture-doc/assets/js/29.37a5f920.js"><link rel="prefetch" href="/reference-architecture-doc/assets/js/3.e8dadafc.js"><link rel="prefetch" href="/reference-architecture-doc/assets/js/30.21d27da2.js"><link rel="prefetch" href="/reference-architecture-doc/assets/js/31.b7f305ac.js"><link rel="prefetch" href="/reference-architecture-doc/assets/js/32.3f3135ee.js"><link rel="prefetch" href="/reference-architecture-doc/assets/js/33.75f280dd.js"><link rel="prefetch" href="/reference-architecture-doc/assets/js/34.e91333d3.js"><link rel="prefetch" href="/reference-architecture-doc/assets/js/35.a858bbcb.js"><link rel="prefetch" href="/reference-architecture-doc/assets/js/4.d9c80617.js"><link rel="prefetch" href="/reference-architecture-doc/assets/js/5.e4e4f7f9.js"><link rel="prefetch" href="/reference-architecture-doc/assets/js/6.125a8a02.js"><link rel="prefetch" href="/reference-architecture-doc/assets/js/7.518ab3a0.js"><link rel="prefetch" href="/reference-architecture-doc/assets/js/8.bdea22b7.js"><link rel="prefetch" href="/reference-architecture-doc/assets/js/9.fb12be10.js">
    <link rel="stylesheet" href="/reference-architecture-doc/assets/css/0.styles.a9215771.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="main-docs-wrapper"><div class="main-content-wrapper"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/reference-architecture-doc/" class="home-link router-link-active"><img src="/reference-architecture-doc/mojaloop_logo_med.png" alt="Mojaloop Reference Architecture Docs 1.0" class="logo"> <span class="site-name can-hide">Mojaloop Reference Architecture Docs 1.0</span></a> <!----> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/reference-architecture-doc/introduction/" class="nav-link">
  Introduction
  <!----></a></div><div class="nav-item"><a href="https://mojaloop.io/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Mojaloop
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div> <!----></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/reference-architecture-doc/introduction/" class="nav-link">
  Introduction
  <!----></a></div><div class="nav-item"><a href="https://mojaloop.io/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Mojaloop
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/reference-architecture-doc/introduction/" class="sidebar-link">Introduction</a></li><li><a href="/reference-architecture-doc/refarch/" class="sidebar-link">Reference Architecture Overview</a></li><li><section class="sidebar-group collapsable depth-0"><a href="/reference-architecture-doc/boundedContexts/" class="sidebar-heading clickable router-link-active open active"><span>Bounded Contexts</span> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 49.484 28.284" class="sidebar-arrow down"><g transform="translate(-229 -126.358)"><rect fill="currentColor" width="35" height="5" rx="2" transform="translate(229 151.107) rotate(-45)"></rect> <rect fill="currentColor" width="35" height="5" rx="2" transform="translate(274.949 154.642) rotate(-135)"></rect></g></svg></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/reference-architecture-doc/boundedContexts/commonTermsConventions/" class="sidebar-link">Common Terms &amp; Conventions</a></li><li><a href="/reference-architecture-doc/boundedContexts/accountLookupAndDiscovery/" class="sidebar-link">Account Lookup &amp; Discovery</a></li><li><a href="/reference-architecture-doc/boundedContexts/accountsAndBalances/" class="sidebar-link">Accounts &amp; Balances</a></li><li><a href="/reference-architecture-doc/boundedContexts/quotingAgreement/" class="sidebar-link">Quoting/Agreements</a></li><li><a href="/reference-architecture-doc/boundedContexts/auditing/" class="sidebar-link">Auditing</a></li><li><a href="/reference-architecture-doc/boundedContexts/fspInteropApi/" class="sidebar-link">FSP Interop API</a></li><li><a href="/reference-architecture-doc/boundedContexts/logging/" class="sidebar-link">Logging</a></li><li><a href="/reference-architecture-doc/boundedContexts/notificationsAndAlerts/" class="sidebar-link">Notifications And Alerts</a></li><li><a href="/reference-architecture-doc/boundedContexts/participantLifecycleManagement/" class="sidebar-link">Participant Lifecycle Management</a></li><li><a href="/reference-architecture-doc/boundedContexts/reporting/" class="sidebar-link">Reporting</a></li><li><a href="/reference-architecture-doc/boundedContexts/scheduling/" aria-current="page" class="active sidebar-link">Scheduling</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/reference-architecture-doc/boundedContexts/scheduling/#terms" class="active sidebar-link">Terms</a></li><li class="sidebar-sub-header"><a href="/reference-architecture-doc/boundedContexts/scheduling/#use-cases" class="sidebar-link">Use Cases</a></li><li class="sidebar-sub-header"><a href="/reference-architecture-doc/boundedContexts/scheduling/#notes" class="sidebar-link">Notes</a></li></ul></li><li><a href="/reference-architecture-doc/boundedContexts/security/" class="sidebar-link">Security</a></li><li><a href="/reference-architecture-doc/boundedContexts/settlements/" class="sidebar-link">Settlements</a></li><li><a href="/reference-architecture-doc/boundedContexts/thirdPartyApi/" class="sidebar-link">Third Party API</a></li><li><a href="/reference-architecture-doc/boundedContexts/transfers/" class="sidebar-link">Transfers</a></li></ul></section></li><li><a href="/reference-architecture-doc/boundedContexts/commonInterfaces/" class="sidebar-link">Common Interface List</a></li><li><a href="/reference-architecture-doc/howToImplement/" class="sidebar-link">How to Implement</a></li><li><a href="/reference-architecture-doc/glossary/" class="sidebar-link">Glossary</a></li><li><a href="/reference-architecture-doc/furtherReading/" class="sidebar-link">Further Reading</a></li></ul> </aside> <main class="page"> <div class="content content__default"><h1 id="scheduling-bc"><a href="#scheduling-bc" class="header-anchor">#</a> Scheduling BC</h1> <p>Multiple processes and events in BCs across the Mojaloop Switch platform require functionality to trigger at specific times, or in accordance with a schedule.  In order to support this requirement across the Switch, and avoid building scheduling functionality into multiple BCs, a single Scheduling BC will be introduced and implemented for the Switch platform.</p> <p>In order to schedule a process or event, a Client BC submits a request to the Scheduling BC to create a reminder for a specific time or time schedule.  The Scheduling BC maintains a schedule of all of the reminders that it receives, and, as the time for reminders is reached, it sends notification of the reminder to the appropriate Client BC.</p> <p>In addition, the Scheduling BC will also provide services to the Switch to enable Client BCs and Switch Admins to manage reminders that are set within the Scheduling BC.</p> <h2 id="terms"><a href="#terms" class="header-anchor">#</a> Terms</h2> <p>The following common term/s are in use in this BC:</p> <table><thead><tr><th>Term</th> <th>Description</th></tr></thead> <tbody><tr><td><strong>Client BC</strong></td> <td>Any other BC making use of the Scheduling BC Services</td></tr></tbody></table> <h2 id="use-cases"><a href="#use-cases" class="header-anchor">#</a> Use Cases</h2> <p>The status of the UCs for the Scheduling BC is as follows:</p> <table><thead><tr><th>Available UCs</th> <th style="text-align:left;"></th> <th></th> <th>Planned UCs</th> <th style="text-align:left;"></th></tr></thead> <tbody><tr><td><strong>Use Case</strong></td> <td style="text-align:left;"><strong>Description</strong></td> <td></td> <td><strong>Use Case</strong></td> <td style="text-align:left;"><strong>Description</strong></td></tr> <tr><td><strong>Create Reminder</strong></td> <td style="text-align:left;">Client BC requests a reminder to be created</td> <td></td> <td><strong>Client Reminder Query</strong></td> <td style="text-align:left;">Client BC queries its own reminders</td></tr> <tr><td><strong>Delete Reminder</strong></td> <td style="text-align:left;">Client BC requests a reminder to be deleted</td> <td></td> <td><strong>Admin Reminder Query</strong></td> <td style="text-align:left;">Platform Admin queries all reminders</td></tr> <tr><td><strong>Reminder Trigger</strong></td> <td style="text-align:left;">Scheduling BC executes reminder trigger when the time comes</td> <td></td> <td></td></tr> <tr><td><strong>Update Reminder</strong></td> <td style="text-align:left;"><em>Not provided.  Recommended solution: delete and create a new Reminder</em></td> <td></td> <td></td> <td style="text-align:left;"></td> <td></td></tr></tbody></table> <h3 id="create-reminder"><a href="#create-reminder" class="header-anchor">#</a> Create Reminder</h3> <h4 id="description"><a href="#description" class="header-anchor">#</a> Description</h4> <p>The workflow provided by this UC enables the Switch to handle authorised Client BC requests to create Reminders.</p> <h4 id="flow-diagram"><a href="#flow-diagram" class="header-anchor">#</a> Flow Diagram</h4> <p><img src="/reference-architecture-doc/assets/img/schedulingCreateReminder_20211021.99c3ac3c.png" alt="Create Reminder"></p> <blockquote></blockquote> <h3 id="reminder-triggered"><a href="#reminder-triggered" class="header-anchor">#</a> Reminder Triggered</h3> <h4 id="description-2"><a href="#description-2" class="header-anchor">#</a> Description</h4> <p>The workflow provided by this UC enables the Switch to handle reminders messaged from the Scheduling BC to a Client BC to execute a task, or as a reminder only.</p> <h4 id="flow-diagram-2"><a href="#flow-diagram-2" class="header-anchor">#</a> Flow Diagram</h4> <p><img src="/reference-architecture-doc/assets/img/schedulingReminderTriggered_20211021.80b8ca13.png" alt="Reminder Triggered"></p> <blockquote></blockquote> <h3 id="delete-recurring-reminder"><a href="#delete-recurring-reminder" class="header-anchor">#</a> Delete (Recurring) Reminder</h3> <h4 id="description-3"><a href="#description-3" class="header-anchor">#</a> Description</h4> <p>The workflow provided by this UC enables the switch to handle messages from authorised Client BCs to the Scheduling BC to delete a Reminder.  In the event that the Scheduling BC is unable to process the instruction, it sends an Alert message to the Notifications BC.</p> <h4 id="flow-diagram-3"><a href="#flow-diagram-3" class="header-anchor">#</a> Flow Diagram</h4> <p><img src="/reference-architecture-doc/assets/img/schedulingDeleteRecurringReminder_20211021.6fc8b3e8.png" alt="Delete (Recurring) Reminder"></p> <blockquote></blockquote> <h2 id="notes"><a href="#notes" class="header-anchor">#</a> Notes</h2> <h4 id="create-reminder-required-data"><a href="#create-reminder-required-data" class="header-anchor">#</a> Create Reminder - Required data</h4> <p>The Create Reminder request needs to include the following data:</p> <table><thead><tr><th>Data</th> <th>Description</th></tr></thead> <tbody><tr><td><strong>Identifier</strong></td> <td>name/id</td></tr> <tr><td><strong>Cron Definition</strong></td> <td>recurring?, time interval?</td></tr> <tr><td><strong>Trigger Transport</strong></td> <td>HTTP Callback/Event; Callback URL or Event Topic</td></tr> <tr><td><strong>Special Payload</strong></td> <td>opaque for the scheduling BC</td></tr> <tr><td><strong>Recovery Conditions</strong></td> <td>retry, reschedule, abort, abandon</td></tr> <tr><td><strong>Alerts</strong></td> <td>notification, logging on exceptions</td></tr> <tr><td><strong>Actions</strong></td> <td>register of automatable/schedulable BC processes</td></tr></tbody></table> <h4 id="scheduling-bc-requirements"><a href="#scheduling-bc-requirements" class="header-anchor">#</a> Scheduling BC - Requirements</h4> <p>The Scheduling BC must meet the following requirements:</p> <ul><li><p>Reminders must be triggered once only</p></li> <li><p>BC must keep track of triggered Reminders</p></li> <li><p>BC must keep track of Create/Read/Delete actions</p> <ul><li>Updates will be facilitated through Delete/Create actions as noted in the <a href="#use-cases">Use Case Available UCs</a> list</li></ul></li> <li><p>Job batches</p></li> <li><p>Offer multiple interface options (gRPC, REST, HTTP, etc.)</p></li> <li><p>Reminders should be triggered with an HTTP callback, not a gRPC call, or to a specific topic</p></li> <li><p>It should have no ability to process logic external to the Scheduling BC itself</p></li> <li><p>Make use of Linux-based UTC timestamps only in order to avoid synchronization issues</p></li></ul> <p><em><strong>Note:</strong></em> <em>It is assumed that the underlying system will keep perfect time.</em></p> <h4 id="scheduling-bc-outstanding-requirements"><a href="#scheduling-bc-outstanding-requirements" class="header-anchor">#</a> Scheduling BC - Outstanding requirements</h4> <p>Access requirements for the Scheduling BC still require definition.</p> <h4 id="scheduling-bc-exceptions"><a href="#scheduling-bc-exceptions" class="header-anchor">#</a> Scheduling BC - Exceptions</h4> <ul><li>Malformed instructions
<ul><li>Invalid date/time, including times in the past</li> <li>Invalid BC or command</li></ul></li> <li>Failed execution (identified through call-back)</li> <li>Insufficient authority for the Client BC to perform the CRD operation</li> <li>Failure to process/execute Reminder</li></ul> <h4 id="questions"><a href="#questions" class="header-anchor">#</a> Questions</h4> <p>A number of questions came up during the Reference Architecture Work Sessions and, as some were felt to have potential value from which others would benefit, we have included them below:</p> <ul><li><p>After the scheduled task has been initiated, does the Scheduling BC remain responsible for tracking its progress?</p> <ul><li>Answer: No. When the Reminder is due, it is communicated to the Client BC using the precribed method, and thereafter, the Scheduling BC responsibility for the reminder is passed back to the Client BC.</li></ul></li> <li><p>Is the Client BC or the person who scheduled a Reminder noted as the “User” by the Scheduling BC?  IOW, whose ID is stamped on the process audit trail?</p> <ul><li>Answer: This should be determined by the Client BC, based on its action on receipt of the Reminder.</li></ul></li></ul></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">1/31/2022, 12:22:50 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/reference-architecture-doc/boundedContexts/reporting/" class="prev">
        Reporting
      </a></span> <span class="next"><a href="/reference-architecture-doc/boundedContexts/security/">
        Security
      </a>
      →
    </span></p></div> </main> <!----></div></div> <!----></div><div class="global-ui"><!----></div></div>
    
    <script src="/reference-architecture-doc/assets/js/app.47e5814f.js" defer></script><script src="/reference-architecture-doc/assets/js/2.3ac1e7fc.js" defer></script><script src="/reference-architecture-doc/assets/js/16.3ac154af.js" defer></script>
  </body>
</html>
